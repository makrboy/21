<!DOCTYPE html>
<html>
<head>
    <style>
        body {
            background-color: black;
            color: #006400;
            font-size: calc(10px + 2vmin);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            text-align: center;
            height: 100vh;
            margin: 0;
            overflow: hidden;
        }

        .button-grid {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 10px;
            margin-bottom: 20px;
        }

        .control-grid {
            display: flex;
            justify-content: space-around;
            width: 90%;
            margin-bottom: 20px;
        }

        button {
            background-color: #006400;
            color: black;
            font-size: 1em;
            padding: 10px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.3s;
        }

        button:hover {
            background-color: #009900;
        }

        input[type=text] {
            color: #006400;
            border: 2px solid #006400;
            border-radius: 5px;
            padding: 5px;
            width: 90%;
            margin-bottom: 20px;
        }

        #output p {
            margin: 5px 0;
        }

        .deck-list-toggle {
            cursor: pointer;
            margin-bottom: 10px;
        }

        .deck-container {
            text-align: left;
            border: 2px solid #006400;
            border-radius: 5px;
            padding: 10px;
            width: 90%;
            height: auto;
            overflow: auto;
        }

        h1 {
            color: #006400;
            margin-bottom: 20px;
        }
    </style>
</head>
<body>
    <h1>21 Calculator</h1>

    <input type="range" min="0" max="100" value="50" class="slider" id="riskLevel">
    <p>Target Risk Level: <span id="riskValue">50</span></p>

    <div class="control-grid">
        <button id="lockButton" onclick="toggleLock()">Unlock Input</button>
        <button onclick="resetDeck()">Reset Deck</button>
    </div>

    <div class="button-grid">
        <button onclick="addNumber(1)">1</button>
        <button onclick="addNumber(2)">2</button>
        <button onclick="addNumber(3)">3</button>
        <button onclick="addNumber(4)">4</button>
        <button onclick="addNumber(5)">5</button>
        <button onclick="addNumber(6)">6</button>
        <button onclick="addNumber(7)">7</button>
        <button onclick="addNumber(8)">8</button>
        <button onclick="addNumber(9)">9</button>
        <button onclick="addNumber(10)">10</button>
    </div>

    <input id="myInput" type="text" placeholder="Current hand total">

    <div id="output">
        <p id="output1"></p>
        <p id="output2"></p>
        <p id="output3"></p>
        <p id="output4"></p>
        <p id="output5"></p>
    </div>

    <p class="deck-list-toggle" id="toggleButton" onclick="toggleDeckList()">Show Deck List</p>
    <div class="deck-container" id="deckList" style="display: none;"></div>

    <script>
        let originalDeck = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 10, 10, 10].flatMap(i => Array(4).fill(i));
        let deck = [...originalDeck];
        let lock = false;

        function resetDeck() {
            deck = [...originalDeck];
            updateDeckDisplay();
            updateOutput(document.getElementById('myInput').value);
        }

        function toggleLock() {
            lock = !lock;
            document.getElementById('lockButton').textContent = lock ? 'Unlock Input' : 'Lock Input';
        }

        function addNumber(num) {
            let index = deck.indexOf(num);
            if (index > -1) {
                deck.splice(index, 1);
            }
            updateDeckDisplay();
            if(!lock) {
                let inputElement = document.getElementById('myInput');
                inputElement.value = parseFloat(inputElement.value || '0') + num;
                updateOutput(document.getElementById('myInput').value);
            }
        }

        function updateDeckDisplay() {
            let groupedDeck = deck.reduce((acc, num) => (acc[num] = (acc[num] || 0) + 1, acc), {});
            let deckList = Object.entries(groupedDeck).map(([card, count]) => `${card}*${count}`).join(', ');
            document.getElementById('deckList').textContent = deckList;
        }

        function toggleDeckList() {
            let deckListElement = document.getElementById('deckList');
            let toggleButton = document.getElementById('toggleButton');
            if (deckListElement.style.display === 'none') {
                deckListElement.style.display = 'block';
                toggleButton.textContent = 'Hide Deck List';
            } else {
                deckListElement.style.display = 'none';
                toggleButton.textContent = 'Show Deck List';
            }
        }

        document.getElementById('riskLevel').addEventListener('input', function(e) {
            document.getElementById('riskValue').textContent = e.target.value;
        });

        document.getElementById('myInput').addEventListener('input', function(e) {
            updateOutput(e.target.value);
        });

        function updateOutput(value) {
            let inputValueFloat = parseFloat(value);
            if (isNaN(inputValueFloat)) {
                clearOutput();
                return;
            }

            let avg = originalDeck.reduce((acc, val) => acc + val) / originalDeck.length;
            let sumWithAvg = inputValueFloat + avg;
            document.getElementById('output1').textContent = 'Input plus average of pool: ' + sumWithAvg.toFixed(2);

            let below21 = 0;
            let exactly21 = 0;
            let above21 = 0;
            deck.forEach(num => {
                let sum = num + inputValueFloat;
                if(sum < 21) {
                    below21++;
                } else if(sum === 21) {
                    exactly21++;
                } else {
                    above21++;
                }
            });

            let total = deck.length;
            let above21Perc = (above21 / total) * 100;
            document.getElementById('output2').textContent = 'Chance of being below 21: ' + ((below21/total) * 100).toFixed(2) + '%';
            document.getElementById('output3').textContent = 'Chance of being exactly 21: ' + ((exactly21/total) * 100).toFixed(2) + '%';
            document.getElementById('output4').textContent = 'Chance of being above 21: ' + above21Perc.toFixed(2) + '%';

            let riskLevel = parseInt(document.getElementById('riskLevel').value, 10);
            document.getElementById('output5').textContent = 'Should you draw another card? ' + (above21Perc > riskLevel ? 'No' : 'Yes');
        }

        function clearOutput() {
            for (let i = 1; i <= 5; i++) {
                document.getElementById('output' + i).textContent = '';
            }
        }

        resetDeck();
    </script>
</body>
</html>
